## 本アプリケーションの概要

### ベンチ画像分類モデル搭載 WebAPI
ベンチの画像であるかどうかを判定する機械学習モデルを実装した WebAPI

### 作成背景
- Courseraの機械学習コースを修了したので勉強した内容のアウトプット
- BenchMapアプリケーション (web、モバイル) に画像判定のバリデーション導入

### 使い方 (例. POSTMAN)
https://bench-map-classifier/api/predict
へdataURI形式の画像データをbodyに指定し、POSTリクエスト。
↓
返却されたJSONのlabelの値が、1ならベンチの画像、0だとベンチの画像でないと判定。


## 機能一覧および使用技術一覧

- ### バックエンド
  - Flask (Python) を使用し、下記の機械学習モデルを組み込み webAPI 化。

- ### 機械学習
  - CNN(畳み込みニューラルネットワーク)のシーケンシャルモデルを採用
  - ベンチ(椅子など座るもの含む)の画像、ベンチでない画像を用意
  - ベンチ画像のラベルを1、ベンチでない画像のラベルを0とし、トレーニングセットおよびクロスバリデーションに分けた後、numpy配列型に変換
  - 正規化したのち、モデルのトレーニングを実行
  - 結果、分類モデルの精度は75%

- ### インフラ
  - Herokuにデプロイ(無料枠内)。その際、下記の制約の中でHerokuにデプロイする必要があった。
    - HerokuのSlugサイズ300MB制約
      - tensorflowのバージョンを調整することで制約をクリア
    - Herokuのメモリ超過エラー(メモリ制約)
      - worker数を減らす
      - メモリにロードするモデルのサイズを減らす(コンパイルせずモデルを保存し、Heroku上でモデルをロード、そこでコンパイルをする)
     上記により制約をクリア。
　

## 今後の課題
- 画像にベンチが小さく写っている場合に、ベンチでない画像であると判定されることが多いので、ベンチが小さく写る画像の量を増やしてトレーニングし改善する予定。
いつまで？
現在、BenchMapアプリケーション(web、モバイル)のベンチ画像判定のバリデーションはGoogleCloudVisionにより対応しているが、アプリが成熟しリクエスト数が増えた場合に課金されることが予想されるので、その時までに、本モデルの改善・実装する予定。